## feed_scheme
### 功能
#### 微博排序模式
* 基础时间线排布微博数据
* 支持用户对关注用户进行分组
* 基于社交关系、发博成本、新鲜程度智能排序

#### 推荐功能
* 牵扯到微博播放量，待填坑

### 方案
#### 存储形式
* 每个用户的每个分组维护一份sorted set,score为发博时间戳，value为微博mid
* 数据量上限？

#### 维护方式
##### 推模式
* 小v用户发布微博，发送异步消息，消费者获取该用户的粉丝列表，给所有粉丝列表的redis set内新增微博midz
* 用户关注小v用户，发送异步消息，消费者将小v用户近期的微博加入redis set
* 用户取关小v用户，发送异步消息，消费者获取redis set中时间戳上下限，根据该时间段获取该用户的所有mid，zrem批量删除mid

##### 拉模式
* 针对大v用户（粉丝数破1w???该数据待验证），该部分用户的mid不进入redis
* 用户拉取feed的时候，取拉取的时间段的上下限，根据该时间段获取用户的所有mid，混入原sorted set 中获取的feed列表中


#### 容灾
##### redis挂了？
若把所有请求转到mysql，分分钟要挂了。。。处理方式待补充

